import{Q as U,s as I,g as T,f as y,r as L,$ as c,i as P,t as R,dJ as A,U as E,O as B,d$ as N,e0 as q,dM as H,n as J,p as _,v as $,x as a,A as r,y as l,z as n,P as W,I as D,L as j,E as z,D as f,aW as K,W as O,X as Q,J as X,K as G}from"./index-78223f15.js";import{v as Y}from"./loading-9148d0db.js";import{E as Z}from"./overlay-46bc55b6.js";import{E as x,a as ee}from"./form-item-8b9adddb.js";import{E as se}from"./pagination-fbb635bb.js";/* empty css              */import"./tag-c15f0a42.js";import"./select-0ae9fab1.js";import"./scrollbar-afb507b1.js";import"./popper-7ac694e5.js";import{E as te,a as ae}from"./table-column-a91ff61f.js";import"./checkbox-9b81128d.js";/* empty css                *//* empty css               *//* empty css             */import{_ as oe}from"./_plugin-vue_export-helper-c27b6911.js";import"./refs-eab7d2f3.js";import"./isUndefined-aa0326a0.js";import"./castArray-c12d26ef.js";import"./_baseClone-95bc8770.js";import"./_Uint8Array-e95ddee1.js";import"./_initCloneObject-cfd68362.js";import"./isEqual-528f6bc1.js";import"./strings-4bc551b5.js";import"./debounce-429b1daa.js";import"./_baseIteratee-58952620.js";import"./hasIn-61fe7d07.js";import"./index-b0526b91.js";import"./flatten-011cba25.js";const le=U({components:{Search:I},setup(){const e=T();let s=y({messageLists:[],page:1,size:30,total:1,loading:!0,dialogVisible:!1,user_nickname:""});const C=L();let b=y({user_nickname:"",message_content:""});const V=(i,o,m)=>{m()},F=y({user_nickname:[{required:!0,message:c("请输入接收人昵称"),trigger:"blur"},{validator:V,trigger:"blur"}],message_content:[{required:!0,message:c("请输入短消息内容"),trigger:"blur"}]}),d=()=>{let i={page:s.page,size:s.size};s.user_nickname&&(i.user_nickname=s.user_nickname),A(i).then(o=>{o.status==200?(s.messageLists=o.data.items,s.total=o.data.records,s.loading=!1):E.error(o.msg),s.loading=!1})},v=(i,o)=>{b.user_nickname=o.user_other_nickname,s.dialogVisible=!0},p=(i,o)=>{B.confirm(c("确定要删除吗?"),{confirmButtonText:c("确定"),cancelButtonText:c("取消"),center:!0}).then(()=>{let m={message_id:o.message_id};N(m).then(h=>{h.status==200?d():E.error(h.msg),s.loading=!1})})},g=()=>{H(b).then(o=>{o.status==200?(s.dialogVisible=!1,s.loading=!1,d()):E.error(o.msg),s.loading=!1})},u=i=>{i&&i.validate(o=>{if(o)console.log("submit!"),g();else return console.log("error submit!"),!1})},k=i=>{q({message_id:i}).then(o=>{o.status&&B.alert(o.data.message_content,"",{cancelButtonText:"Cancel",center:!0,callback:m=>{d()}})})};return P(()=>{d()}),{getMessage:d,handleReply:v,handleDelete:p,submitForm:u,read:k,form:b,ruleFormRef:C,rules:F,counter:e,...R(s)}}});const w=e=>(O("data-v-da650f23"),e=e(),Q(),e),ne={class:"tab-content pd0 pt20"},ie={class:"animation-slide-left tab-message active",id:"account_content"},re={class:"row form-inline"},de={class:"col-sm-3"},ue={class:"vertical-top",style:{display:"inline-block"}},me=w(()=>a("i",{class:"fa-pencil"},null,-1)),pe={class:"col-sm-9"},ge={class:"vertical-top pull-right"},ce={class:"btn btn-gray btn-icon btn-icon-standalone hide",id:"msg_remove_btn"},_e=w(()=>a("i",{class:"fa-trash"},null,-1)),fe={class:"mailbox-env"},be={key:0,class:"label label-danger"},he={key:1,class:"label label-success"},ve=["onClick","innerHTML"],ke={class:"sortPagiBar"},ye={class:"bottom-pagination"},Ee={class:"manage-edit-box mail-compose",id:"compose-mail",style:{width:"600px"}},$e={class:"mail-header",style:{"padding-left":"20px"}},we=w(()=>a("i",{class:"fa fa-pencil"},null,-1)),Ce={class:"box-main"};function Ve(e,s,C,b,V,F){const d=J("Search"),v=X,p=G,g=j,u=ae,k=te,i=se,o=x,m=ee,h=Z,S=Y;return _(),$("div",ne,[a("div",ie,[a("div",re,[a("div",de,[a("div",ue,[a("button",{class:"btn btn-primary btn-icon btn-icon-standalone",onClick:s[0]||(s[0]=()=>{e.dialogVisible=!0})},[me,a("span",null,r(e.$t("写短信")),1)])])]),a("div",pe,[a("div",ge,[l(g,{modelValue:e.user_nickname,"onUpdate:modelValue":s[1]||(s[1]=t=>e.user_nickname=t),type:"search",class:"w-50 m-2",size:"large",placeholder:e.$t("用户昵称")},{append:n(()=>[l(p,{size:"small",onClick:e.getMessage},{default:n(()=>[l(v,{size:30,color:"#333"},{default:n(()=>[l(d)]),_:1})]),_:1},8,["onClick"])]),_:1},8,["modelValue","placeholder"]),a("button",ce,[_e,a("span",null,r(e.$t("删除")),1)])])])]),a("section",fe,[W((_(),D(k,{ref:"multipleTableRef",data:e.messageLists,style:{width:"100%"},onSelectionChange:e.handleSelectionChange},{default:n(()=>[l(u,{type:"selection",width:"55"}),l(u,{label:e.$t("用户"),width:"150"},{default:n(t=>[t.row.message_type==1?(_(),$("span",be,r(e.$t("系统")),1)):z("",!0),t.row.message_is_read?z("",!0):(_(),$("span",he,r(e.$t("未读")),1)),f(" "+r(t.row.user_other_nickname),1)]),_:1},8,["label"]),l(u,{property:"message_content",label:e.$t("消息"),width:"250"},{default:n(t=>[a("span",{style:{cursor:"pointer"},onClick:M=>e.read(t.row.message_id),innerHTML:t.row.message_content},null,8,ve)]),_:1},8,["label"]),l(u,{property:"message_time",label:e.$t("时间"),"show-overflow-tooltip":""},{default:n(t=>[f(r(new Date(parseInt(t.row.message_time)).toLocaleString().replace(/年|月/g,"-").replace(/日/g," ")),1)]),_:1},8,["label"]),l(u,{label:e.$t("操作"),width:"200"},{default:n(t=>[l(p,{size:"small",onClick:M=>e.handleReply(t.$index,t.row)},{default:n(()=>[f(r(e.$t("回复")),1)]),_:2},1032,["onClick"])]),_:1},8,["label"])]),_:1},8,["data","onSelectionChange"])),[[S,e.loading]])])]),a("div",ke,[a("div",ye,[a("nav",null,[(_(),D(i,{currentPage:e.page,"onUpdate:currentPage":s[2]||(s[2]=t=>e.page=t),"page-size":e.size,"onUpdate:pageSize":s[3]||(s[3]=t=>e.size=t),"page-sizes":[30,60,90,120],small:!1,disabled:!1,background:!0,layout:"prev,pager,next,total,jumper",total:e.total,key:e.page,onSizeChange:s[4]||(s[4]=t=>{e.size=t,e.getMessage()}),onCurrentChange:s[5]||(s[5]=t=>{e.page=t,e.getMessage()})},null,8,["currentPage","page-size","total"]))])])]),l(h,{modelValue:e.dialogVisible,"onUpdate:modelValue":s[10]||(s[10]=t=>e.dialogVisible=t),width:"700px",draggable:""},{default:n(()=>[a("div",Ee,[a("div",$e,[a("h3",null,[we,f(" "+r(e.$t("写短信")),1)])]),a("div",Ce,[l(m,{model:e.form,ref:"ruleFormRef","label-position":e.counter.labelPosition,onSubmit:s[9]||(s[9]=K(()=>{},["prevent"])),rules:e.rules,"label-width":"120px"},{default:n(()=>[l(o,{label:e.$t("短消息接收人"),prop:"user_nickname"},{default:n(()=>[l(g,{modelValue:e.form.user_nickname,"onUpdate:modelValue":s[6]||(s[6]=t=>e.form.user_nickname=t)},null,8,["modelValue"])]),_:1},8,["label"]),l(o,{label:e.$t("短消息内容"),prop:"message_content"},{default:n(()=>[l(g,{modelValue:e.form.message_content,"onUpdate:modelValue":s[7]||(s[7]=t=>e.form.message_content=t)},null,8,["modelValue"])]),_:1},8,["label"]),l(o,null,{default:n(()=>[l(p,{type:"primary","native-type":"submit",onClick:s[8]||(s[8]=t=>e.submitForm(e.ruleFormRef))},{default:n(()=>[f(r(e.$t("确定")),1)]),_:1})]),_:1})]),_:1},8,["model","label-position","rules"])])])]),_:1},8,["modelValue"])])}const ts=oe(le,[["render",Ve],["__scopeId","data-v-da650f23"]]);export{ts as default};
