import{Q as w,f as $,r as A,$ as d,i as L,t as P,U as F,O as S,p,v as D,x as _,y as o,z as s,P as T,I as C,F as y,K as q,D as g,A as f,C as I,L as R}from"./index-78223f15.js";import{v as M}from"./loading-9148d0db.js";import{E as N}from"./overlay-46bc55b6.js";import{E as O,a as j}from"./form-item-8b9adddb.js";/* empty css              */import"./tag-c15f0a42.js";import{a as K,E as Q}from"./select-0ae9fab1.js";import"./scrollbar-afb507b1.js";import"./popper-7ac694e5.js";import{E as G}from"./pagination-fbb635bb.js";import{E as H,a as J}from"./table-column-a91ff61f.js";import"./checkbox-9b81128d.js";/* empty css                *//* empty css               */import{f as W,r as X,s as Y}from"./pay-9a19a417.js";import{_ as Z}from"./_plugin-vue_export-helper-c27b6911.js";import"./refs-eab7d2f3.js";import"./isUndefined-aa0326a0.js";import"./castArray-c12d26ef.js";import"./_baseClone-95bc8770.js";import"./_Uint8Array-e95ddee1.js";import"./_initCloneObject-cfd68362.js";import"./strings-4bc551b5.js";import"./isEqual-528f6bc1.js";import"./debounce-429b1daa.js";import"./_baseIteratee-58952620.js";import"./hasIn-61fe7d07.js";import"./index-b0526b91.js";import"./flatten-011cba25.js";const x=w({setup(){let e=$({userBankLists:[],bank_list:[],page:1,size:30,total:1,loading:!0,dialogVisible:!1});const r=A();let n=$({id:0,bank_name:"",bank_id:0,user_bank_card_address:"",user_bank_card_code:"",user_bank_card_name:"",user_bank_card_mobile:""});const U=(t,a,u)=>{n.bank_id!=1018&&n.bank_id!=1019&&a==""?u(new Error(d("请输入支行地址"))):u()},z=$({bank_name:[{required:!0,message:d("请选择支付方式"),trigger:"blur"}],user_bank_card_address:[{validator:U,trigger:"blur"}],user_bank_card_code:[{required:!0,message:d("请输入银行卡号或微信支付宝账号"),trigger:"blur"}],user_bank_card_name:[{required:!0,message:d("请输入持卡人或收款人姓名"),trigger:"blur"}],user_bank_card_mobile:[{required:!0,message:d("请输入预留的手机号"),trigger:"blur"}]}),b=()=>{var t={page:e.page,size:e.size};W(t).then(a=>{a.status==200?(e.userBankLists=a.data.items,e.bank_list=a.data.bank_list.items,e.total=a.data.records,e.loading=!1):F.error(a.msg)})},m=()=>{n.id=0,n.bank_name="",n.bank_id=0,n.user_bank_card_address="",n.user_bank_card_code="",n.user_bank_card_name="",n.user_bank_card_mobile="",e.dialogVisible=!0},i=(t,a)=>{console.log(a),n.id=a.id,n.bank_name=a.bank_name,n.bank_id=a.bank_id,n.user_bank_card_address=a.user_bank_card_address,n.user_bank_card_code=a.user_bank_card_code,n.user_bank_card_name=a.user_bank_card_name,n.user_bank_card_mobile=a.user_bank_card_mobile,e.dialogVisible=!0},c=(t,a)=>{let u={id:a.user_bank_id};S.confirm(d("确定移除这个账号吗?"),{confirmButtonText:d("确定"),cancelButtonText:d("取消"),center:!0}).then(()=>{X(u).then(k=>{k.status==200?(e.loading=!0,b()):F.error(k.msg)})})},B=t=>{n.bank_id=t;for(var a in e.bank_list)e.bank_list[a].bank_id==t&&(n.bank_name=e.bank_list[a].bank_name)},E=t=>{t&&t.validate(a=>{if(a)console.log("submit!"),V();else return console.log("error submit!"),!1})},V=()=>{let t=n,a=1;n.id&&(a=2),Y(t,a).then(u=>{u.status==200?(e.dialogVisible=!1,e.loading=!0,b()):F.error(u.msg)})};return L(()=>{b()}),{getUserBank:b,handleEdit:i,handleDelete:c,selectBack:B,addUserBank:m,form:n,ruleFormRef:r,rules:z,submitForm:E,...P(e)}}}),ee={class:"tab-content pd0 pt20"},ae={class:"animation-slide-left tab-message active",id:"account_content"},le={class:"alert alert-default",role:"alert"},re={class:"sortPagiBar"},ne={class:"bottom-pagination"};function oe(e,r,n,U,z,b){const m=q,i=J,c=H,B=G,E=K,V=Q,t=O,a=R,u=j,k=N,h=M;return p(),D(y,null,[_("div",ee,[_("div",ae,[_("div",le,[o(m,{type:"warning",onClick:e.addUserBank},{default:s(()=>[g(f(e.$t("添加银行卡")),1)]),_:1},8,["onClick"])]),T((p(),C(c,{data:e.userBankLists,style:{width:"100%"}},{default:s(()=>[o(i,{prop:"bank_id",label:e.$t("用户卡ID"),width:"120"},null,8,["label"]),o(i,{prop:"bank_name",label:e.$t("银行名称"),width:"100"},null,8,["label"]),o(i,{prop:"user_bank_card_code",label:e.$t("银行卡卡号"),width:"200"},null,8,["label"]),o(i,{prop:"user_id",label:e.$t("持卡人"),width:"100"},null,8,["label"]),o(i,{label:e.$t("操作"),width:"250"},{default:s(l=>[o(m,{size:"small",onClick:v=>e.handleEdit(l.$index,l.row)},{default:s(()=>[g(f(e.$t("修改")),1)]),_:2},1032,["onClick"]),o(m,{size:"small",type:"danger",onClick:v=>e.handleDelete(l.$index,l.row)},{default:s(()=>[g(f(e.$t("删除")),1)]),_:2},1032,["onClick"])]),_:1},8,["label"])]),_:1},8,["data"])),[[h,e.loading]])]),_("div",re,[_("div",ne,[_("nav",null,[(p(),C(B,{currentPage:e.page,"onUpdate:currentPage":r[0]||(r[0]=l=>e.page=l),"page-size":e.size,"onUpdate:pageSize":r[1]||(r[1]=l=>e.size=l),"page-sizes":[36,72,108,144],small:!1,disabled:!1,background:!0,layout:"prev,pager,next,total,jumper",total:e.total,key:e.page,onSizeChange:r[2]||(r[2]=l=>{e.size=l,e.getUserBank()}),onCurrentChange:r[3]||(r[3]=l=>{e.page=l,e.getUserBank()})},null,8,["currentPage","page-size","total"]))])])])]),o(k,{modelValue:e.dialogVisible,"onUpdate:modelValue":r[10]||(r[10]=l=>e.dialogVisible=l),width:"700px",draggable:""},{default:s(()=>[o(u,{ref:"ruleFormRef",model:e.form,rules:e.rules,"label-width":"160px"},{default:s(()=>[o(t,{label:e.$t("收款方式"),prop:"bank_name"},{default:s(()=>[o(V,{modelValue:e.form.bank_name,"onUpdate:modelValue":r[4]||(r[4]=l=>e.form.bank_name=l),placeholder:e.$t("请选择收款方式"),onChange:e.selectBack},{default:s(()=>[(p(!0),D(y,null,I(e.bank_list,(l,v)=>(p(),C(E,{key:v,label:l.bank_name,value:l.bank_id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder","onChange"])]),_:1},8,["label"]),o(t,{label:e.$t("开户支行"),prop:"user_bank_card_address"},{default:s(()=>[o(a,{modelValue:e.form.user_bank_card_address,"onUpdate:modelValue":r[5]||(r[5]=l=>e.form.user_bank_card_address=l)},null,8,["modelValue"])]),_:1},8,["label"]),o(t,{label:e.$t("收款账户"),prop:"user_bank_card_code"},{default:s(()=>[o(a,{modelValue:e.form.user_bank_card_code,"onUpdate:modelValue":r[6]||(r[6]=l=>e.form.user_bank_card_code=l)},null,8,["modelValue"])]),_:1},8,["label"]),o(t,{label:e.$t("收款人姓名"),prop:"user_bank_card_name"},{default:s(()=>[o(a,{modelValue:e.form.user_bank_card_name,"onUpdate:modelValue":r[7]||(r[7]=l=>e.form.user_bank_card_name=l)},null,8,["modelValue"])]),_:1},8,["label"]),o(t,{label:e.$t("手机号"),prop:"user_bank_card_mobile"},{default:s(()=>[o(a,{modelValue:e.form.user_bank_card_mobile,"onUpdate:modelValue":r[8]||(r[8]=l=>e.form.user_bank_card_mobile=l)},null,8,["modelValue"])]),_:1},8,["label"]),o(t,null,{default:s(()=>[o(m,{type:"primary",onClick:r[9]||(r[9]=l=>e.submitForm(e.ruleFormRef))},{default:s(()=>[g(f(e.$t("确定")),1)]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])],64)}const Se=Z(x,[["render",oe]]);export{Se as default};
