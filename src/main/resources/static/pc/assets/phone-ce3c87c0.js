import{Q as w,r as h,f as $,g as E,$ as v,i as A,t as R,U as d,as as D,at as I,au as U,p as c,v as z,I as g,z as o,E as M,y as u,D as y,A as m,L as S,K as N}from"./index-78223f15.js";import{a as T,E as q}from"./form-item-8b9adddb.js";/* empty css               *//* empty css              */import"./tag-c15f0a42.js";import{a as O,E as K}from"./select-0ae9fab1.js";import"./scrollbar-afb507b1.js";import"./popper-7ac694e5.js";import{_ as L}from"./_plugin-vue_export-helper-c27b6911.js";import"./castArray-c12d26ef.js";import"./_baseClone-95bc8770.js";import"./_Uint8Array-e95ddee1.js";import"./_initCloneObject-cfd68362.js";import"./strings-4bc551b5.js";import"./isEqual-528f6bc1.js";import"./debounce-429b1daa.js";import"./_baseIteratee-58952620.js";import"./hasIn-61fe7d07.js";import"./index-b0526b91.js";import"./isUndefined-aa0326a0.js";const P=w({setup(){const e=h();let l=$({userRows:{}});const{userInfo:V}=E();l.userRows=V,console.log(l.userRows);const a=$({mobile:l.userRows.user_mobile,auth_code:"",user_intl:"+86"});let _=h(1);const k=$({mobile:[{required:!0,message:v("请输入手机号"),trigger:"blur"}],auth_code:[{required:!0,message:v("请输入验证码"),trigger:"blur"}]});h("");const p=h(!0),s=h(),f=h(60),t=h();let i=()=>{let n={};if(!a.mobile){d.error(v("请输入手机号"));return}n.mobile=a.user_intl+a.mobile,D(n).then(F=>{F.status==200?(s.value||(t.value=f.value,p.value=!1,s.value=setInterval(()=>{t.value>0&&t.value<=f.value?(t.value--,console.log("count----",t)):(p.value=!0,clearInterval(s.value),s.value=null)},1e3)),d.success(v("验证码已经发送成功，请尽快输入验证码!"))):d.error(F.msg)})};const C=n=>{n&&n.validate(F=>{if(F){if(a.mobile==l.userRows.user_mobile){d.error(v("你已经绑定过该手机！"));return}let B={verify_code:a.auth_code,verify_key:a.user_intl+a.mobile};I(B).then(b=>{b.status==200?d.success(v("手机号绑定成功!")):d.error(b.msg)}).catch(b=>{d.error(b.msg)})}else return console.log("error submit!"),!1})},r=n=>{n&&n.validate(F=>{if(F){console.log("submit!");var B={code:a.auth_code};U(B).then(b=>{b.status==200?(clearInterval(s.value),a.mobile="",a.auth_code="",a.user_intl="+86",p.value=!0,t.value="",_.value=1):d.error(b.msg)})}else return console.log("error submit!"),!1})};return A(()=>{}),{...R(l),ruleFormRef:e,ruleForm:a,rules:k,count:t,ishow:p,type:_,submitForm:C,getCode:i,rebind:r}}});const Q={class:"account-container"};function j(e,l,V,a,_,k){const p=O,s=K,f=S,t=q,i=N,C=T;return c(),z("div",Q,[e.type==1?(c(),g(C,{key:0,ref:"ruleFormRef",rules:e.rules,model:e.ruleForm,"label-position":"left","label-width":"120px"},{default:o(()=>[u(t,{label:e.$t("手机号"),prop:"mobile"},{default:o(()=>[u(f,{modelValue:e.ruleForm.mobile,"onUpdate:modelValue":l[1]||(l[1]=r=>e.ruleForm.mobile=r),class:"input-style",placeholder:e.$t("请输入手机号")},{prepend:o(()=>[u(s,{modelValue:e.ruleForm.user_intl,"onUpdate:modelValue":l[0]||(l[0]=r=>e.ruleForm.user_intl=r),placeholder:"Select",style:{width:"90px"}},{default:o(()=>[u(p,{label:"+86",value:"+86"})]),_:1},8,["modelValue"])]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),u(t,{label:e.$t("验证码"),prop:"auth_code"},{default:o(()=>[u(f,{modelValue:e.ruleForm.auth_code,"onUpdate:modelValue":l[2]||(l[2]=r=>e.ruleForm.auth_code=r),placeholder:e.$t("请输入验证码"),class:"input-style"},{append:o(()=>[e.ishow?(c(),g(i,{key:0,style:{padding:"0",height:"45px","min-width":"102px","font-size":"14px",color:"#fff","border-bottom-left-radius":"0","border-top-left-radius":"0"},onClick:e.getCode},{default:o(()=>[y(m(e.$t("获取验证码")),1)]),_:1},8,["onClick"])):(c(),g(i,{key:1,style:{padding:"0","min-width":"102px","font-size":"14px",color:"#fff",height:"45px"}},{default:o(()=>[y(m(e.count)+" s "+m(e.$t("后获取")),1)]),_:1}))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),u(t,null,{default:o(()=>[u(i,{type:"primary",onClick:l[3]||(l[3]=r=>e.submitForm(e.ruleFormRef))},{default:o(()=>[y(m(e.$t("确认绑定")),1)]),_:1})]),_:1})]),_:1},8,["rules","model"])):e.type==2?(c(),g(C,{key:1,ref:"ruleFormRef",rules:e.rules,model:e.ruleForm,"label-position":"left","label-width":"120px"},{default:o(()=>[u(t,{label:e.$t("手机号"),prop:"mobile"},{default:o(()=>[u(f,{modelValue:e.ruleForm.mobile,"onUpdate:modelValue":l[5]||(l[5]=r=>e.ruleForm.mobile=r),class:"input-style",placeholder:e.$t("请输入手机号"),disabled:"true"},{prepend:o(()=>[u(s,{modelValue:e.ruleForm.user_intl,"onUpdate:modelValue":l[4]||(l[4]=r=>e.ruleForm.user_intl=r),placeholder:"Select",style:{width:"90px",height:"45px","line-height":"45px"}},{default:o(()=>[u(p,{label:"+86",value:"+86"})]),_:1},8,["modelValue"])]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),u(t,{label:e.$t("验证码"),prop:"auth_code"},{default:o(()=>[u(f,{modelValue:e.ruleForm.auth_code,"onUpdate:modelValue":l[6]||(l[6]=r=>e.ruleForm.auth_code=r),placeholder:e.$t("请输入验证码"),class:"input-style"},{append:o(()=>[e.ishow?(c(),g(i,{key:0,style:{padding:"0",height:"45px","min-width":"102px","font-size":"14px",color:"#fff"},onClick:e.getCode},{default:o(()=>[y(m(e.$t("获取验证码")),1)]),_:1},8,["onClick"])):(c(),g(i,{key:1,style:{padding:"0","min-width":"102px","font-size":"14px",color:"#fff",height:"45px"}},{default:o(()=>[y(m(e.count)+" s "+m(e.$t("后获取")),1)]),_:1}))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),u(t,null,{default:o(()=>[u(i,{type:"primary",onClick:l[7]||(l[7]=r=>e.rebind(e.ruleFormRef))},{default:o(()=>[y(m(e.$t("重新绑定")),1)]),_:1})]),_:1})]),_:1},8,["rules","model"])):M("",!0)])}const pe=L(P,[["render",j],["__scopeId","data-v-fecca49e"]]);export{pe as default};
