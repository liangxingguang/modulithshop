import{Q as H,r as m,N as D,g as W,u as P,e as Y,f as U,$ as l,w as Z,dO as ee,i as te,n as oe,p as _,v as g,x as i,aU as e,y as s,z as a,A as p,D as y,F as E,I as j,E as I,aW as le,U as h,as as se,ax as re,L as ae,K as ne,J as ie,W as ue,X as de,e6 as pe}from"./index-78223f15.js";import{E as ce,a as _e}from"./form-item-8b9adddb.js";/* empty css             */import{E as me}from"./image-viewer-32b8c113.js";/* empty css               */import{_ as fe}from"./Verify-393aa695.js";/* empty css              */import"./tag-c15f0a42.js";import{a as ge,E as ye}from"./select-0ae9fab1.js";import"./scrollbar-afb507b1.js";import"./popper-7ac694e5.js";import{_ as he}from"./_plugin-vue_export-helper-c27b6911.js";import"./castArray-c12d26ef.js";import"./_baseClone-95bc8770.js";import"./_Uint8Array-e95ddee1.js";import"./_initCloneObject-cfd68362.js";import"./debounce-429b1daa.js";import"./strings-4bc551b5.js";import"./isEqual-528f6bc1.js";import"./_baseIteratee-58952620.js";import"./hasIn-61fe7d07.js";import"./index-b0526b91.js";import"./isUndefined-aa0326a0.js";const O=b=>(ue("data-v-802a24f1"),b=b(),de(),b),ve={class:"login-container login"},be={class:"square"},we={class:"leftSquare"},xe=["src"],ke={class:"rightSquare"},Ve=O(()=>i("div",{class:"errors-container"},null,-1)),Ce={class:"login-header"},Ue={class:"logo"},Ee={style:{float:"left","margin-left":"69px"}},Ie={style:{float:"right","margin-right":"65px","font-size":"16px"}},Se={class:"text-left"},qe={class:"login-footer hidden"},Fe={class:"external-login-small",style:{"margin-right":"20px"}},Me=O(()=>i("i",{class:"fa-wechat",style:{"margin-top":"5px"}},null,-1)),Ne=[Me],Re=H({__name:"login",setup(b){m("");const S=m();D.tokenName;const q=W(),k=P();Y();const F=W(),T=m(""),V=m(!0),w=m(),M=m(60),v=m(),A=Math.random(),Q=n=>F.login(n),t=U({user_account:"",user_mobile:"",username:"",user_password:"",verify_code:"",user_intl:"+86",bind_type:2,is_verify:!1}),N=n=>{t.is_verify=n},J=U({user_account:[{required:!0,message:l("请输入账号"),trigger:"blur"}],user_mobile:[{required:!0,message:l("请输入手机号"),trigger:"blur"}],user_password:[{required:!0,message:l("请输入密码"),trigger:"change"}],verify_code:[{required:!0,message:l("请输入验证码"),trigger:"change"}]});U({});let R=m(""),$=()=>{pe().then(n=>{n.status==200?window.location.href=n.data:h.error(n.msg)})},C=()=>{let n={};if(t.bind_type==1){if(!t.is_verify){h.error(l("请拖动滑块完成验证"));return}if(!t.user_mobile){h.error(l("请输入手机号"));return}n.mobile=t.user_intl+t.user_mobile,se(n).then(o=>{o.status==200?(h.success(l("验证码已经发送成功，请尽快输入验证码!")),w.value||(v.value=M.value,V.value=!1,w.value=setInterval(()=>{v.value>0&&v.value<=M.value?(v.value--,console.log("count----",v)):(V.value=!0,clearInterval(w.value),w.value=null)},1e3))):h.error(o.msg)})}else re({verify_key:A}).then(o=>{if(o){console.log(o);let d=new FileReader;d.onload=function(u){R.value=u.target.result},d.readAsDataURL(o)}})};const K=n=>{n&&n.validate(async o=>{if(o)try{let d={verify_code:t.verify_code};if(t.bind_type==1)d.user_mobile=t.user_intl+t.user_mobile,d.verify_key=t.user_intl+t.user_mobile;else{let u=t.user_account;if(t.bind_type==2){if(!t.is_verify){h.error(l("请拖动滑块完成验证"));return}u=t.user_intl+u}d.username=u,d.user_account=u,d.password=t.user_password}await Q(d).then(async u=>{k.go(-1)}).catch(u=>{console.error(u),h.error(u.msg)})}finally{}else return console.log("error submit!"),!1})};return Z(()=>{}),ee({config_key:"account_login_bg"}).then(n=>{n.status==200&&(T.value=n.data[0].config_value)}),te(()=>{C();const n=k.currentRoute.value.query.ukey;if(n){let o={user_nickname:"",user_avatar:""};F.afterLogin(n,D.tokenName,o)}q.hasLogin&&k.push({path:"/index"})}),(n,o)=>{const d=oe("router-link"),u=ge,z=ye,f=ae,c=ce,B=fe,x=ne,X=me,L=ie,G=_e;return _(),g("div",null,[i("div",ve,[i("div",be,[i("div",we,[i("img",{src:e(q).info.account_login_bg,style:{"border-radius":"10px 0px 0px 10px"}},null,8,xe)]),i("div",ke,[Ve,s(G,{class:"login-form",ref_key:"ruleFormRef",ref:S,model:e(t),rules:e(J),"label-width":"69px","label-position":"left",onSubmit:o[14]||(o[14]=le(()=>{},["prevent"]))},{default:a(()=>[i("div",Ce,[i("a",Ue,[i("span",Ee,p(e(l)("账号登录")),1),i("span",Ie,[s(d,{to:{path:"/login/register"}},{default:a(()=>[y(p(e(l)("立即注册")),1)]),_:1})])])]),e(t).bind_type==2?(_(),g(E,{key:0},[s(c,{label:e(l)(""),prop:"user_account"},{default:a(()=>[s(f,{modelValue:e(t).user_account,"onUpdate:modelValue":o[1]||(o[1]=r=>e(t).user_account=r),modelModifiers:{number:!0},placeholder:e(l)("请输入手机号"),class:"input-with-select"},{prepend:a(()=>[s(z,{modelValue:e(t).user_intl,"onUpdate:modelValue":o[0]||(o[0]=r=>e(t).user_intl=r),placeholder:"Select",class:"user_intl",style:{width:"90px",height:"45px","line-height":"45px"}},{default:a(()=>[s(u,{label:"+86",value:"+86",style:{height:"45px"}})]),_:1},8,["modelValue"])]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),s(c,null,{default:a(()=>[s(B,{onUpdate:N,handlerWidth:"74"})]),_:1}),s(c,{label:e(l)(""),prop:"user_password"},{default:a(()=>[s(f,{modelValue:e(t).user_password,"onUpdate:modelValue":o[2]||(o[2]=r=>e(t).user_password=r),autocomplete:"new-password",type:"password",placeholder:e(l)("请输入密码"),class:"input-with-select"},null,8,["modelValue","placeholder"])]),_:1},8,["label"])],64)):e(t).bind_type==1?(_(),g(E,{key:1},[s(c,{label:e(l)(""),prop:"user_mobile"},{default:a(()=>[s(f,{modelValue:e(t).user_mobile,"onUpdate:modelValue":o[4]||(o[4]=r=>e(t).user_mobile=r),modelModifiers:{number:!0},placeholder:e(l)("请输入手机号"),class:"input-with-select"},{prepend:a(()=>[s(z,{modelValue:e(t).user_intl,"onUpdate:modelValue":o[3]||(o[3]=r=>e(t).user_intl=r),placeholder:"Select",class:"user_intl",style:{width:"90px",height:"45px","line-height":"45px"}},{default:a(()=>[s(u,{label:"+86",value:"+86",style:{height:"45px"}})]),_:1},8,["modelValue"])]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),s(c,null,{default:a(()=>[s(B,{onUpdate:N,handlerWidth:"74"})]),_:1}),s(c,{class:"verify-code",label:e(l)(""),prop:"verify_code"},{default:a(()=>[s(f,{style:{width:"291px","font-size":"16px",height:"45px","margin-right":"8px"},modelValue:e(t).verify_code,"onUpdate:modelValue":o[5]||(o[5]=r=>e(t).verify_code=r),autocomplete:"new-password",placeholder:e(l)("验证码")},null,8,["modelValue","placeholder"]),e(V)?(_(),j(x,{key:0,type:"primary",class:"send-code",onClick:e(C)},{default:a(()=>[y(p(e(l)("发送验证码")),1)]),_:1},8,["onClick"])):(_(),j(x,{key:1,style:{padding:"0",width:"102px"}},{default:a(()=>[y(p(e(v))+" s "+p(e(l)("后获取")),1)]),_:1}))]),_:1},8,["label"])],64)):(_(),g(E,{key:2},[s(c,{label:e(l)(""),prop:"user_account"},{default:a(()=>[s(f,{modelValue:e(t).user_account,"onUpdate:modelValue":o[6]||(o[6]=r=>e(t).user_account=r),autocomplete:"off",class:"input-with-select",placeholder:e(l)("请输入账号")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),s(c,{label:e(l)(""),prop:"user_password"},{default:a(()=>[s(f,{modelValue:e(t).user_password,"onUpdate:modelValue":o[7]||(o[7]=r=>e(t).user_password=r),autocomplete:"new-password",type:"password",placeholder:e(l)("请输入密码"),class:"input-with-select"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),s(c,{label:e(l)(""),prop:"verify_code"},{default:a(()=>[s(f,{style:{overflow:"hidden"},modelValue:e(t).verify_code,"onUpdate:modelValue":o[8]||(o[8]=r=>e(t).verify_code=r),placeholder:e(l)("验证码"),class:"input-with-select"},{append:a(()=>[s(x,{style:{padding:"0",width:"102px",display:"inherit","background-color":"unset !important"},onClick:e(C)},{default:a(()=>[s(X,{class:"img-responsive",style:{height:"41px"},src:e(R)},null,8,["src"])]),_:1},8,["onClick"])]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])],64)),s(c,null,{default:a(()=>[s(x,{type:"primary",size:"large",style:{width:"409px",height:"45px","font-size":"21px"},"native-type":"submit",onClick:o[9]||(o[9]=r=>K(e(S)))},{default:a(()=>[y(p(e(l)("登录")),1)]),_:1})]),_:1}),i("div",Se,[e(t).bind_type!=2?(_(),g("a",{key:0,href:"javascript:void(0)",class:"mobile",onClick:o[10]||(o[10]=r=>e(t).bind_type=2)},[s(L),y(p(e(l)("手机号登录")),1)])):I("",!0),e(t).bind_type!=0?(_(),g("a",{key:1,href:"javascript:void(0)",class:"mobile",style:{"margin-left":"65px"},onClick:o[11]||(o[11]=r=>e(t).bind_type=0)},p(e(l)("账号登录")),1)):I("",!0),e(t).bind_type!=1?(_(),g("a",{key:2,href:"javascript:void(0)",style:{"margin-left":"70px"},onClick:o[12]||(o[12]=r=>e(t).bind_type=1)},[s(L,{class:"location"}),y(p(e(l)("验证码登录")),1)])):I("",!0)]),s(d,{style:{"margin-right":"60px",float:"right","margin-top":"-25px"},to:{path:"/login/findpwd"}},{default:a(()=>[y(p(e(l)("忘记密码？")),1)]),_:1}),i("div",qe,[i("span",Fe,p(e(l)("其他账号登录")),1),i("span",{class:"wechat external-login-small",onClick:o[13]||(o[13]=(...r)=>e($)&&e($)(...r))},Ne)])]),_:1},8,["model","rules"])])])])])}}});const st=he(Re,[["__scopeId","data-v-802a24f1"]]);export{st as default};
