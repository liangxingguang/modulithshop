import{Q as B,g as M,r as u,f as k,$ as l,p as v,v as q,y as s,z as a,aU as e,I as x,D as g,A as c,aW as N,L as T,K as $,at as D,U as m,as as P}from"./index-78223f15.js";import{E as R,a as A}from"./form-item-8b9adddb.js";/* empty css               *//* empty css              */import{_ as K}from"./_plugin-vue_export-helper-c27b6911.js";import"./castArray-c12d26ef.js";import"./_baseClone-95bc8770.js";import"./_Uint8Array-e95ddee1.js";import"./_initCloneObject-cfd68362.js";const L={class:"tab-content"},O=B({__name:"password",setup(Q){const{userInfo:w,labelPosition:C}=M(),f=u(!0),p=u(),y=u(60),i=u();let h=u(!1);w.user_mobile&&(h.value=!0);const I=u("default"),V=u();u("");let t=k({mobile:w.user_mobile,password:"",auth_code:"",user_intl:"+86"});const E=k({mobile:[{required:!0,message:l("请输入手机号"),trigger:"blur"}],password:[{required:!0,message:l("请输入密码"),trigger:"change"}],auth_code:[{type:"date",required:!0,message:l("请输入验证码"),trigger:"change"}]}),U=()=>{let r={mobile:"+86"+t.mobile,password:t.password,auth_code:t.auth_code,user_intl:"+86",mobile_id:"pc"};D(r).then(o=>{o.status==200?m.success(l("密码修改成功")):m.error(o.msg)})},F=async r=>{r&&await r.validate((o,d)=>{o?(console.log("submit!"),U()):console.log("error submit!",d)})};let S=()=>{if(!t.mobile){m.error("请输入手机号");return}P({mobile:t.mobile}).then(r=>{r.status==200?(p.value||(i.value=y.value,f.value=!1,p.value=setInterval(()=>{i.value>0&&i.value<=y.value?(i.value--,console.log("count----",i)):(f.value=!0,clearInterval(p.value),p.value=null)},1e3)),m.success("验证码已经发生成功，请尽快输入验证码!")):m.error(r.msg)})};return(r,o)=>{const d=T,_=R,b=$,z=A;return v(),q("div",L,[s(z,{ref_key:"ruleFormRef",ref:V,model:e(t),rules:e(E),"label-width":"160px","label-position":e(C),onSubmit:o[4]||(o[4]=N(()=>{},["prevent"])),size:e(I)},{default:a(()=>[s(_,{label:e(l)("手机号"),prop:"mobile"},{default:a(()=>[s(d,{disabled:e(h),modelValue:e(t).mobile,"onUpdate:modelValue":o[0]||(o[0]=n=>e(t).mobile=n)},null,8,["disabled","modelValue"])]),_:1},8,["label"]),s(_,{label:e(l)("新密码"),prop:"password"},{default:a(()=>[s(d,{modelValue:e(t).password,"onUpdate:modelValue":o[1]||(o[1]=n=>e(t).password=n)},null,8,["modelValue"])]),_:1},8,["label"]),s(_,{label:e(l)("验证码")},{default:a(()=>[s(d,{modelValue:e(t).auth_code,"onUpdate:modelValue":o[2]||(o[2]=n=>e(t).auth_code=n),prop:"auth_code",placeholder:""},{append:a(()=>[e(f)?(v(),x(b,{key:0,style:{padding:"0",width:"102px"},onClick:e(S)},{default:a(()=>[g(c(e(l)("获取验证码")),1)]),_:1},8,["onClick"])):(v(),x(b,{key:1,style:{padding:"0",width:"102px"}},{default:a(()=>[g(c(e(i))+" s "+c(e(l)("后获取")),1)]),_:1}))]),_:1},8,["modelValue"])]),_:1},8,["label"]),s(_,null,{default:a(()=>[s(b,{type:"primary","native-type":"submit",onClick:o[3]||(o[3]=n=>F(e(V)))},{default:a(()=>[g(c(e(l)("确认修改")),1)]),_:1})]),_:1})]),_:1},8,["model","rules","label-position","size"])])}}});const oe=K(O,[["__scopeId","data-v-17260964"]]);export{oe as default};
